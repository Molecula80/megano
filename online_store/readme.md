# Онлаййн магазин Megano

### Инструкция по установке и первому запуску 

Установить зависимости:

```bash
pipenv install
```

Активиовать виртуальное окружение:

```bash
pipenv shell
```

Перейти в папку проекта:

```bash
cd online_store
```

Провести миграцию:

```bash
python manage.py migrate
```

Создать суперпользователя:

```bash
python manage.py createsuperuser
```

Загрузить группы пользователей из файла фикстур:
```bash
python manage.py loaddata auth/groups.json
```

Загрузить пользователей из файла фикстур:
```bash
python manage.py loaddata app_users/users.json
```

Загрузить категории, производителей и продавцов из файла фикстур:
```bash
python manage.py loaddata app_catalog/categories.json
python manage.py loaddata app_catalog/fabricators.json
python manage.py loaddata app_catalog/sellers.json
```

Загрузить товары из файла фикстур:
```bash
python manage.py loaddata app_catalog/products.json
```

Загрузить пункты описания, пункты дополнительной информации и отзывы из файла фикстур:
```bash
python manage.py loaddata app_catalog/descr_points.json
python manage.py loaddata app_catalog/add_info_points.json
python manage.py loaddata app_catalog/reviews.json
```

Загрузить способы доставки из файла фикстур:
```bash
python manage.py loaddata app_ordering/delivery_methods.json
```

Загрузить заказы из файла фикстур:
```bash
python manage.py loaddata app_ordering/orders.json
```

Загрузить единицы заказа из файла фикстур:
```bash
python manage.py loaddata app_ordering/order_items.json
```

Запустить веб-сервер проекта:

```bash
python manage.py runserver
```

### Регистрация и авторизация
Перейдите на главную страницу по адресу http://127.0.0.1:8000/. Если у вас нет 
аккаунта, вы можете создать его. Для этого перейдите по ссылке 
[зарегистриаоваться](http://127.0.0.1:8000/app_users/register/) в шапке сайта, введите 
свои данные в форму и нажмите кнопку ```Сохранить```. Вы будете перенаправлены обратно 
на главную 
страницу. Если у вас есть аккаунт вы можете войти в систему. Для этого перейдите по 
ссылке [войти](http://127.0.0.1:8000/app_users/login/), введите email и пароль и 
нажмите на кнопку.

Пароли пользователей, загруженных из фикстур:

__user1@gmail.com:__ PasswordU1

__user2@gmail.com:__ PasswordU2

__user3@gmail.com:__ PasswordU3

Если вы не помните свой пароль, перейдите по ссылке 
"[Забыли пароль?](http://127.0.0.1:8000/app_users/password_reset/)" и введите свой 
email адрес. На вашу почту будет отправлено письмо. Перейдите по ссылке в этом письме,
дважды введите новый пароль и нажмите на кнопку ```Change me password```. Пароль 
будет изменен.

Неавторизованные пользователи могут смотреть товары и добавлять их в корзину.
Авторизованные пользователи могут оформлять заказы и писать отзывы о товарах. 
Пользователи принадлежащие к группе _Staff_ имеют доступ к [административной 
панели](http://127.0.0.1:8000/admin/). С её помощью они могут создавать, редактировать 
и удалять пользователей, категории, производителей, продавцов, товары, пункты 
описания, пункты дополнительной информации, отзывы, заказы, единицы заказа и 
способы доставки. 

### Шапка и футтер

Шапка сайта содержит [ссылку на страницу товаров с бесплатной 
доставкой](http://127.0.0.1:8000/catalog/delivery/free/). Перейдя по ней вы попадете
на страницу каталога товаров, на которой отображаются только товары с бесплатной 
доставкой. Также есть ссылки на соцсети [facebook](https://www.facebook.com/), 
[twitter](https://twitter.com/), [instagram](https://www.instagram.com/),
[pinterest](https://ru.pinterest.com/) и [mail.com](https://www.mail.com/). 
Нажав на логотип Megano вы попадете на [главную страницу](http://127.0.0.1:8000/). 
Еще в шапке есть ссылки [главную страницу](http://127.0.0.1:8000/), [каталог 
товаров](http://127.0.0.1:8000/catalog/) и [корзину](http://127.0.0.1:8000/app_cart/).
Также имеется раскрывающийся список, содержащий ссылки на все категории товаров. 
Перейдя по любой из этих ссылок вы попадете на страницу каталога товаров, на которой будут 
отображаться только товары выбранной категории. Еще есть поле для поиска товаров.
Введите текст в это поле и нажмите кнопку ```Поиск```, и вас перенаправит на страницу 
каталога. На ней будут отображаться только те товары, название или описание которых
содержит введенный вами текст.

Футтер сайта содержит ссылки на соцсети, [главную страницу](http://127.0.0.1:8000/), 
[каталог товаров](http://127.0.0.1:8000/catalog/), [товары с бесплатной 
доставкой](http://127.0.0.1:8000/catalog/delivery/free/), 
[корзину](http://127.0.0.1:8000/app_cart/), а также на шесть избранных категорий 
товаров.

### Главная страница и каталог

В верхней части [главной страницы](http://127.0.0.1:8000/) расположены ссылки на три 
избранные категории 
товаров. Ниже находятся ссылки на восемь самых популярных товаров и шестнадцать товаров с 
ограниченным тиражом. Кликнув по названию или изображению товара, вы попадете на 
детальную страницу последнего. Кликнув по отзывам,
вы перейдете на детальную страницу товара сразу к отзывам. Если данный товар имеется 
в наличии, подведите
курсор в его нижнюю часть и появится иконка в виде корзины. Нажав на эту иконку вы 
добавите товар в [корзину](http://127.0.0.1:8000/app_cart/), после чего попадете
на страницу последней. Если данный товар уже имеется в вашей корзине его количество 
увеличится на один. 

На [странице каталога](http://127.0.0.1:8000/catalog/) находятся ссылки на товары. 
Весь каталог разбит на страницы, по восемь товаров на каждой. 
Внизу расположены ссылки на эти страницы, а также стрелки, с помощью которых 
вы можете перейти на следующую или 
предыдущую страницы. Наверху находятся ссылки, с помощью которых вы можете 
отсортировать товары по количеству покупок, цене, количеству отзывов и новизне. 

В левой части страницы расположен фильтр. С его помощью вы можете выбрать товары подходящие
по цене; тексту, содержащемся в названии или описании; производителям; продавцам. Вы также 
можете выбрать только товары, имеющиеся в наличии, или с бесплатной доставкой. Нажмите на 
кнопку применить и отобразятся только товары с указанными вами параметрами. Под фильтром
располагаются ссылки на самые популярные категории товаров.  

На детальной странице товара вы можете добавить его в корзину. Для этого введите 
количество товара и нажмите на кнопку ```Добавить в корзину```. Если в вашей корзине уже
имеется данный товар, его количество увеличится на введенное вами значение. Вы также можете
почитать отзывы о товаре. Для этого перейдите на вкладку отзывы. На вкладке отображено
последние три отзыва. Если вы хотите почитать другие отзывы, нажмите на кнопку показать 
ещё. Если вы авторизированны на сайте, вы можете оставить свой собственный отзыв. Для
этого заполните форму и нажмите на кнопку ```Добавить отзыв```.

### Оформление заказа и личный кабинет

На [странице корзины](http://127.0.0.1:8000/app_cart/) вы можете изменить количество 
товара, нажимая на знаки ```+``` или ```-``` а также удалить товар из корзины, нажав на
кнопку с иконкой в виде ведра. Для того чтобы купить товары, нажмите на кнопку 
```Оформить заказ```. 

Первым делом вы должны ввести Ф. И. О., email и телефон. Если вы не авторизованы, 
вам также необходимо ввести пароль, после чего произойдет попытка вашей регистрации.
Если пользователь с указанным вами email уже существует, появится всплывающее окно с
формой для регистрации. Если у вас уже есть аккаунт, нажмите на кнопку 
```Я уже зарегистрирован```, после чего появится всплывающее окно с формой для 
авторизации. Введите в эту форму свой email и пароль и нажмите на кнопку
```Войти```, после чего будет выполнен вход в систему.

Затем вам необходимо выбрать способ доставки, а также ввести город и адрес. Если 
суммарная стоимость всех товаров в корзине меньше __2000$__ и в корзине есть хотя бы 
один товар с платной доставкой, обычная
доставка стоит __200$__. В противном случае она бесплатная. Экспресс доставка стоит 
__500$__, вне зависимости от стоимости товаров и наличия товаров с бесплатной доставкой.
Суперпользователи и пользователи принадлежащие к группе ___staff___ могут изменять 
стоимость доставки, а также стоимость заказа, начиная с которой доставка становится 
бесплатной. Изменять вышеуказанные параметры можно с помощью 
[административной панели](http://127.0.0.1:8000/admin/).

Затем вам необходимо выбрать способ оплаты и подтвердить заказ нажав на кнопку 
```Оплатить```. Перед нажатием на кнопку можно ввести коментарий к заказу. Затем вас
перенаправит на страницу оплаты. Если вы выбрали способ оплаты ___онлайн картой___,
введите в поле номер карты и нажмите на кнопку ```Оплатить```. Номер должен быть четным
и не оканчиваться на ноль, иначе система сгенерирует ошибку оплаты. Если вы выбрали способ
___онлайн со случайного чужого счета___, нажмите на кнопку 
```Сгенерировать случайный счет```, после чего система автоматически сгенерирует 
случайный номер, и нажмите на кнопку ```Оплатить```. После этого ваш заказ добавится в 
очередь, и вас перенаправит на страницу ожидания оплаты заказа. Если оплата заказа прошла
успешно вы вскоре получите сообщение о том, что заказ оплачен. В противном случае вы 
получите сообщение об ошибке.

Если вы авторизованы, в шапке сайта отображается ссылка на ваш личный кабинет. В личном 
кабинете есть ссылка на [страницу редактирования 
профиля](http://127.0.0.1:8000/app_users/profile/). Здесь вы можете изменить свои данные
и пароль. Также в личном кабинете есть ссылки на ваш последний заказ и 
[историю заказов](http://127.0.0.1:8000/app_users/orders_history/). История заказов 
содержит ссылки на детальные страницы всех когда-либо сделанных вами заказов. Если 
заказ не был оплачен, на странице заказа отобразится ссылка ```Оплатить```, нажав на
которую вы сможете снова выбрать способ оплаты и оплатить заказ.

### Административная панель

Если вы являетесь суперпользователем или принадлежите к группе ___Staff___, вы можете
создавать редактировать или удалять пользователей, категории, производителей, 
продавцов, товары, пункты описания, пункты дополнительной информации, отзывы, 
заказы, единицы заказа и способы доставки. Делать это можно с помощью 
[административной панели](http://127.0.0.1:8000/admin/).

Для доступа к административной панели перейдите по адресу http://127.0.0.1:8000/admin/.
Для того чтобы добавить новую запись, перейдите на страницу интересующей вас модели
и нажмите на кнопку ```Add (название модели)``` в правом верхнем углу. Введите данные
в форму и нажмите на кнопку ```Save```. Для того чтобы редактировать запись, перейдите 
на её детальную страницу, введите новые данные и нажмите кнопку ```Save```. Для удаления
записи нажмите кнопку ```Delete``` на детальной странице.
